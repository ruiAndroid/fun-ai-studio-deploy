#
# fun-ai-studio-deploy - production profile
# 说明：
# - 本文件作为生产环境基准配置（以后以此为准）
# - 请务必替换所有 CHANGE_ME_* 为强随机值，并在安全组/防火墙上收敛来源
#

server.port=7002
spring.application.name=funaistudiodeploy

spring.mvc.pathmatch.matching-strategy=ANT_PATH_MATCHER

# Swagger UI（生产可按需关闭）
springdoc.swagger-ui.path=/swagger-ui
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.enabled=true
spring.web.resources.add-mappings=true
springdoc.api-docs.enabled=true

logging.level.root=INFO

# -----------------------------
# 日志落盘（deploy 控制面）
# -----------------------------
# 目标文件（持续写入）
logging.file.name=/data/funai/logs/fun-ai-studio/fun-ai-studio-deploy/app.log
#
# 按天滚动 + 按大小分片（必须包含 %i；gzip 压缩）
# 生成示例：app.2026-01-20.0.log.gz
logging.logback.rollingpolicy.file-name-pattern=/data/funai/logs/fun-ai-studio/fun-ai-studio-deploy/app.%d{yyyy-MM-dd}.%i.log.gz
# 单文件最大大小（超过会在同一天内滚动到下一个 %i）
logging.logback.rollingpolicy.max-file-size=100MB
# 保留最近 30 天
logging.logback.rollingpolicy.max-history=30
# 总日志大小上限（超过会清理旧日志）
logging.logback.rollingpolicy.total-size-cap=5GB
# 启动时清理超期日志
logging.logback.rollingpolicy.clean-history-on-start=true

# -----------------------------
# Deploy Admin（内部运维接口鉴权）
# -----------------------------
deploy.admin.enabled=true
# 可选：只允许指定来源 IP 访问 /admin/**（逗号分隔）；为空则不校验
deploy.admin.allowed-ips=
# 必填：运维接口 Token（Header：X-Admin-Token），生产请替换为强随机值
deploy.admin.token=9e6b0c7d1a4f3b2c8d5e0f9a7c6b1d3e4a8f2c0d9b7e6a5c1f3d8b0e2a7c4d1f

# -----------------------------
# Runtime Node Registry（runtime 节点心跳注册）
# -----------------------------
deploy.runtime-node-registry.enabled=true
# 可选：只允许 runtime 节点来源 IP 访问 /internal/runtime-nodes/heartbeat（逗号分隔）；为空则不校验
deploy.runtime-node-registry.allowed-ips=
# 必填：节点心跳 Token（Header：X-RT-Node-Token），生产请替换为强随机值
deploy.runtime-node-registry.shared-secret=4c1d7e9a2b0f6d3c8a5e1f0b9d7c3a2e6f8b4d1a0c9e7b5f3d2a8c6e1b0f9d7a
# 心跳超时阈值（秒）：超过视为不健康（选择策略会过滤）
deploy.runtime-node-registry.heartbeat-stale-seconds=60


